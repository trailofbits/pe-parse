language: cpp

os:
- linux
- osx

before_install:
- ./travis.sh "$TRAVIS_OS_NAME" initialize
script:
- ./travis.sh "$TRAVIS_OS_NAME" build

matrix:
  include:
  - os: linux
    compiler: clang++-5.0
    env: TOOLSET=clang COMPILER=clang++-5.0 CXXSTD=c++11
    addons: { apt: { packages: ["clang-5.0"], sources: ["llvm-toolchain-trusty-5.0"] } }
  - os: linux
    env: TOOLSET=gcc COMPILER=g++-6 CXXSTD=c++11
    addons: { apt: { packages: ["gcc++-6"], sources: ["ubuntu-toolchain-r-test"] } }
  - os: osx
    env: TOOLSET=clang COMPILER=clang++ CXXSTD=c++14
    osx_image: xcode9.3

env:
  global:
  - secure: "O+BGqz4ugoVIJbQTh0dJjKRrsSVzkCYSe0WpRzEWK3l8Mw7hqX300g81TxRwTzN2zfUsROMzaeGaXWfGzYakgW59K1WIioaczxtv2MzzUQTbqzJPa+qQoP9bk/b2wJ5jcOL965/rudRju4UiIwuIgzDAMN3nAfIEJgV/2zANLIg="

addons:
  coverity_scan:
    project:
      name: "trailofbits/pe-parse"
      description: "Principled, lightweight C/C++ PE parser"
    notification_email: dan@trailofbits.com
    build_command: "./travis.sh linux build"
    branch_pattern: master
